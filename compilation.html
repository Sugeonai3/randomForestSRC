<h3>Source Code, Beta Builds and Bug Reporting</h3>

<p>Regular stable releases of this package
are available on CRAN at
<a href="https://cran.r-project.org/package=randomForestSRC">https://cran.r-project.org/package=randomForestSRC</a>.
Interim unstable development builds with bug fixes and sometimes additional
functionality are available at
<a href="https://github.com/kogalur/randomForestSRC">https://github.com/kogalur/randomForestSRC</a>.
Bugs may be reported via <a href="https://github.com/kogalur/randomForestSRC/issues/new">https://github.com/kogalur/randomForestSRC/issues/new</a>.
Please provide the accompanying
information with any reports:
</p>

<ol>
<li> <p><code>sessionInfo()</code>
</p>
</li>
<li><p> A minimal reproducible example consisting of the following items:
</p>

<ul>
<li><p> a minimal dataset, necessary to reproduce the error
</p>
</li>
<li><p> the minimal runnable code necessary to reproduce the error, 
which can be run on the given dataset
</p>
</li>
<li><p> the necessary information on the used packages, R version and system it is run on
</p>
</li>
<li><p> in the case of random processes, a seed (set by <code>set.seed()</code>) for reproducibility
</p>
</li></ul>

</li></ol>



<h3>OpenMP Parallel Processing &ndash; Installation</h3>

<p>This package
implements OpenMP shared-memory parallel programming.  However, the
default installation will only execute serially.  To utilize OpenMP,
the target architecture and operating system must support it.
</p>
<p>An understanding of resource utilization (CPU and RAM) is necessary
when running the package using OpenMP and Open MPI parallel execution.
Memory usage is greater when running with OpenMP
enabled.  Diligence should be used not to overtax the hardware available.
</p>
<p>There are THREE strategies for installing the OpenMP capable version
of the CRAN package.  <b>Method 1</b> relies on having full package
development prerequisites, the build environment necessary for
creating R packages from source.  This is the preferred and
comprehensive way to guarantee natively compiled, compatible and
optimized binaries for your system.  <b>Method 2</b> relies on having
partial package development prerequisites.  This makes some
assumptions about your system, that are not entirely platform
independent, but will usually work.  <b>Method 3</b> is the easiest
and does not require package development prerequisites.  Method 3
relies on pre-built binaries, and is intended for users not interested
in investing the time necessary to have the capability to natively
build packages. We do not recommend this method as it does not
guarantee OpenMP execution, nor does it guarantee that our binaries
will even be compatible with your system.  However, we are providing
them as a convenience.
</p>

<table summary="Rd table">
<tr>
 <td style="text-align: center;">
    <code><b>[ METHOD ]</b></code> </td><td style="text-align: center;"> <code><b>[ R Development Toolset ]</b></code> 
    </td><td style="text-align: center;"> <code><b>[  Difficulty ]</b></code> 
    </td><td style="text-align: center;"> <code><b>[ OpenMP Execution ]</b></code> </td>
</tr>
<tr>
 <td style="text-align: center;">
    <code>1</code> </td><td style="text-align: center;"> <code>Full</code> </td><td style="text-align: center;"> <code>High</code> </td><td style="text-align: center;"> <code>Guaranteed</code> </td>
</tr>
<tr>
 <td style="text-align: center;">
    <code>2</code> </td><td style="text-align: center;"> <code>Partial</code> </td><td style="text-align: center;"> <code>Medium</code> </td><td style="text-align: center;">
    <code>Good Success</code> </td>
</tr>
<tr>
 <td style="text-align: center;">
    <code>3</code> </td><td style="text-align: center;"> <code>None</code> </td><td style="text-align: center;"> <code>Low</code> </td><td style="text-align: center;"> <code>Moderate Success</code>
  </td>
</tr>

</table>



<h4>OpenMP Parallel Processing &ndash; Method 1</h4>

<p>The core software development utilities required for R package
development vary by operating system.  The difficulty of installing
this build environment also varies by operating system.  Unix-based
systems are the friendliest, followed by Mac OS X, followed lastly by
Windows.  Detailed descriptions on how this is achieved are available
on a number of sites online and will not be reproduced here.  Once the
R package development environment is in place, it is possible to build
our package natively on your platform using the following steps:
</p>

<ol>
<li><p> Download the package source code
<code>randomForestSRC_X.x.x.tar.gz</code> from CRAN or GitHub (see above).  The
X's indicate the version posted. Do not download the CRAN binary!
</p>
</li>
<li><p> Open a console, navigate to the directory containing the
tarball, and untar it using the command
</p>
<p><code>tar -xvf randomForestSRC_X.x.x.tar.gz</code>
</p>
</li>
<li><p> This will create a directory structure with the root directory
of the package named <code>randomForestSRC</code>.  Change into the root
directory of the package using the command
</p>
<p><code>cd randomForestSRC</code>
</p>
</li>
<li><p> Run autoconf using the command
</p>
<p><code>autoconf</code>
</p>
</li>
<li><p> Change back to your working directory using the command
</p>
<p><code>cd ..</code>
</p>
</li>
<li><p> From your working directory, execute the command
</p>
<p><code>R CMD INSTALL --preclean --clean randomForestSRC</code>
</p>
<p>on the modified
package.  Ensure that you do not target the unmodified tarball, but
instead act on the directory structure you just modified.
</p>
</li></ol>




<h4>OpenMP Parallel Processing &ndash; Method 2</h4>

<p>This method hard codes some OpenMP compiler directives.  On Windows systems
this method is generally easier than Method 1.  The
instruction for this method follow:
</p>

<ol>
<li><p> Download the package source code from CRAN or GitHub (see above).  The
X's indicate the version posted. Do not download the CRAN binary!
</p>
</li>
<li><p> Open a console, navigate to the directory containing the
tarball, and untar it using the command
</p>
<p><code>tar -xvf randomForestSRC_X.x.x.tar.gz</code>
</p>
</li>
<li><p> This will create a directory structure with the root directory
of the package named <code>randomForestSRC</code>.
</p>
</li>
<li><p> Download the Makevars file containing the custom compiler
directives from
<a href="http://www.ccs.miami.edu/~hishwaran/rfsrc/Makevars">http://www.ccs.miami.edu/~hishwaran/rfsrc/Makevars</a>.  Copy it
into the directory <code>randomForestSRC/src</code>. On Windows
systems, take the additional step of renaming it to
<code>Makevars.win</code>.
</p>
</li>
<li><p> From your working directory, execute the command
</p>
<p><code>R CMD INSTALL --preclean --clean randomForestSRC</code>
</p>
<p>on the modified package.  Ensure that you do not target the
unmodified tarball, but instead act on the directory structure you
just modified.
</p>
</li></ol>




<h4>OpenMP Parallel Processing &ndash; Method 3</h4>

<p>The easiest but least recommended way to install the OpenMP version of
the package is to download our pre-compiled binaries and attempt to
use them on your system. Successful execution is not always
guaranteed.  The instruction for this method follow:
</p>

<ol>
<li><p> Download the platform specific binary file
<code>randomForestSRC_X.x.x.&lt;extension&gt;</code> from
<a href="http://www.ccs.miami.edu/~hishwaran/rfsrc.html">http://www.ccs.miami.edu/~hishwaran/rfsrc.html</a>.
</p>
</li>
<li><p> From the R GUI, navigate to &quot;Install Packages&quot; (or similar)
and select &quot;From Local Archive&quot; (or similar).  Then navigate to the
downloaded binary and click &quot;Install&quot;.  If you are not using the R
GUI, navigate to the directory where you downloaded the compressed
binary file and execute the command
</p>
<p><code>R CMD INSTALL randomForestSRC_X.x.x.zip</code>
</p>
</li></ol>




<h4>OpenMP Parallel Processing &ndash; Setting the Number of CPUs</h4>

<p>There are several ways to control the number of CPU cores that the
package accesses during OpenMP parallel execution.  First, you will
need to determine the number of cores on your local machine.  Do this
by starting an R session and issuing the command
<code>detectCores()</code>.  You will require the <span class="pkg">parallel</span> package
for this.
</p>
<p>Then you can do the following:
</p>
<p>At the start of every R session, you can set the number of cores
accessed during OpenMP parallel execution by issuing the command
<code>options(rf.cores = x)</code>, where <code>x</code> is the number of
cores.  If <code>x</code> is a negative number, the package will access
the maximum number of cores on your machine.  The options command can
also be placed in the users .Rprofile file for convenience.  You can,
alternatively, initialize the environment variable <code>RF_CORES</code>
in your shell environment.
</p>
<p>The default value for rf.cores is -1 (-1L), if left unspecified, which
uses all available cores, with a minimum of two.
</p>



<h4>R-side Parallel Processing &ndash; Setting the Number of CPUs</h4>

<p>The package also implements R-side parallel processing via the
<code>parallel</code> package contained in the base <code>R</code>
distribution.  However, the <code>parallel</code> package must be explicitly loaded to take
advantage of this functionality.  When this is the case, the 
R function <code>lapply()</code> is replaced with the parallel version
<code>mclapply()</code>.  You can
set the number of cores accessed by <code>mclapply()</code> by issuing
the command
</p>
<p><code>options(mc.cores = x)</code>
</p>
<p>where <code>x</code> is the number of cores.  The options command
can also be placed in the users .Rprofile file for convenience.  You
can, alternatively, initialize the environment variable
<code>MC_CORES</code> in your shell environment.  See the help files in
<span class="pkg">parallel</span> for more information.
</p>
<p>The default value for <code>mclapply()</code> on non-Windows systems is
two (2L) cores.  On Windows systems, the default value is one (1L)
core.
</p>



<h4>Example: Setting the Number of CPUs</h4>

<p>As an example, issuing the following options command uses all
available cores for both OpenMP and R-side processing:
</p>
<p><code>options(rf.cores=detectCores(), mc.cores=detectCores())</code>
</p>
<p>As stated above, this option command can be placed in the users
.Rprofile file.
</p>



<h4>Cautionary Note on Parallel Execution</h4>


<ol>
<li><p> Once the package has been compiled with OpenMP enabled, trees
will be grown in parallel using the <code>rf.cores</code> option.
Independently of this, we also utilize <code>mclapply()</code> to
parallelize loops in R-side pre-processing and post-processing
of the forest.  This is always available and independent of
whether the user chooses to compile the package with the OpenMP
option enabled.
</p>
</li>
<li><p> It is important to NOT write programs that fork R processes
containing OpenMP threads.  That is, one should not use
<code>mclapply()</code> around the functions <code>rfsrc()</code>,
<code>predict.rfsrc()</code>, <code>vimp.rfsc()</code>,
<code>var.select.rfsrc()</code>, <code>find.interaction.rfsrc()</code> and <code>partial.rfsrc()</code>.
In such a scenario, program execution is not guaranteed.
</p>
</li></ol>
